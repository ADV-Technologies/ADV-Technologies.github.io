<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADV Technologies - Innovative Solutions</title>

    <link rel="icon" type="image/png" href="/assets/logo.png">
    <link rel="apple-touch-icon" href="/assets/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/css/styles.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>

    <style>
        /* Add minimal styling for the contact list for better readability */
        .contact-list {
            list-style: none;
            padding: 0;
            margin-top: 1.5rem;
        }
        .contact-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.8);
        }
        .contact-list a {
            color: var(--gold);
            text-decoration: none;
            word-break: break-all;
        }
        .contact-list a:hover {
            text-decoration: underline;
        }
        .coming-soon-link {
            color: #ccc;
            cursor: default;
        }
    </style>

</head>
<body>
    <canvas id="particles-canvas"></canvas>

    <nav class="navbar" id="navbar">
        <div class="container">
            <div class="logo">
                <img src="/assets/logo.png" alt="ADV Technologies Logo">
                <span style="font-weight: 700;">ADV</span>
            </div>
            <div class="menu-items">
                <a href="#about-me">About Me</a>
                <a href="#projects">Projects</a>
                <a href="#contact">Contact</a>
            </div>
            
            <div class="user-profile" id="user-profile" style="display: none;">
                <div class="user-avatar" id="user-avatar">?</div>
                <span id="profile-username">User</span>
                <a href="/dashboard/" class="btn-small" style="margin-left: 1rem; text-decoration: none;">Dashboard</a>
                <button class="btn-small" onclick="window.authFunctions.logout()" style="margin-left: 0.5rem;">Logout</button>
            </div>
            
            <div class="auth-buttons" id="auth-buttons">
                <a href="/login/" class="btn-secondary">Login</a>
                <a href="/register/" class="btn-primary">Register</a>
            </div>
        </div>
    </nav>

    <header class="hero section">
        <div class="container">
            <div class="hero-content">
                <h1 id="hero-text-1">Welcome to ADV Technologies</h1>
                <p class="tagline" id="hero-text-2">Innovation with Integrity, Secured by Design.</p>
                <div class="hero-actions">
                    <a href="#projects" class="btn-primary">Explore Our Work</a>
                </div>
            </div>
        </div>
    </header>
    
    <section class="about section" id="about-me">
        <div class="container">
            <div class="glass-panel">
                <h2 id="about-me-title">About Me</h2>
                <p id="about-me-content" class="about-content">
                    Loading content...
                </p>
                <a href="#" class="btn-secondary" style="margin-top: 1rem;">Learn More About Me</a>
            </div>
        </div>
    </section>

    <section class="about section" id="about-adv">
        <div class="container">
            <div class="glass-panel">
                <h2 id="about-adv-title">About ADV Technologies</h2>
                <p id="about-adv-content" class="about-content">
                    Loading content...
                </p>
            </div>
        </div>
    </section>

    <section class="projects section" id="projects">
        <div class="container">
            <div class="glass-panel">
                <div class="projects-content">
                    <h2>Our Projects</h2>
                    <div class="projects-grid" id="landing-projects-grid">
                        <div style="text-align: center; color: var(--gold); width: 100%;">
                            <i class="fas fa-spinner fa-spin"></i> Loading Projects...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="contact section" id="contact">
        <div class="container">
             <div class="glass-panel">
                <h2>Contact Us</h2>
                <p style="margin-bottom: 1rem;">ADV Technologies (Professional)</p>
                
                <ul class="contact-list" id="contact-professional-list">
                    <li><i class="fas fa-spinner fa-spin"></i> Loading Contact Info...</li>
                </ul>

                <h4 style="margin-top: 2rem; color: var(--gold);">Personal</h4>
                
                <ul class="contact-list" id="contact-personal-list">
                    <li><i class="fas fa-spinner fa-spin"></i> Loading Personal Info...</li>
                </ul>
                
                <p id="contact-message" style="margin-top: 1rem; color: var(--gold);"></p>
            </div>
        </div>
    </section>
    
    <footer class="footer">
        <div class="container">
            <p>&copy; <span id="current-year">2025</span> ADV Technologies. All rights reserved.</p>
            <div class="footer-links">
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </footer>


    <script>
        // Set up the Supabase configuration globally
        window.SUPABASE_CONFIG = {
            url: 'https://xblihylcpepkuriatqtg.supabase.co',
            anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhibGloeWxjcGVwa3VyaWF0cXRnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxMDEwNDIsImV4cCI6MjA3NzY3NzA0Mn0.Ka_dkjTcPmzfhTBmCrUNrfxU_G8UncebUwM5h-wlhns'
        };
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>

    <script src="/js/config.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/particles.js"></script>
    <script src="/js/auth.js"></script>

    <script>
        // --- Helper function to render text content (About Sections) ---
        function renderPageContent(contentData, key) {
            const data = contentData.find(item => item.page_key === key);
            if (data) {
                // Set Hero Text (although common.js handles settings, this is a fallback)
                if (key === 'hero_text_1') document.getElementById('hero-text-1').textContent = data.content;
                if (key === 'hero_text_2') document.getElementById('hero-text-2').textContent = data.content;
                
                // Set About Sections
                if (key === 'about_me') {
                    document.getElementById('about-me-title').textContent = data.title;
                    document.getElementById('about-me-content').textContent = data.content;
                } else if (key === 'about_adv') {
                    document.getElementById('about-adv-title').textContent = data.title;
                    document.getElementById('about-adv-content').textContent = data.content;
                }
            }
        }

        // --- Function to Render Contact Links ---
        function renderContactLinks(contactData) {
            const profContainer = document.getElementById('contact-professional-list');
            const personalContainer = document.getElementById('contact-personal-list');
            if (!profContainer || !personalContainer) return;
            
            profContainer.innerHTML = '';
            personalContainer.innerHTML = '';

            const linkData = contactData.sort((a, b) => a.platform.localeCompare(b.platform));

            linkData.forEach(item => {
                // Determine platform and type
                const platform = item.platform.replace('_professional', '').replace('_personal', '');
                const isEmail = item.platform.includes('email');
                
                let url = item.url;
                let displayUrl = url;
                let iconClass = 'fa-link';
                let typeText = '';

                // Set Icon and Display Text
                if (isEmail) {
                    iconClass = 'fa-envelope';
                    displayUrl = url.replace('mailto:', '');
                    typeText = 'Email';
                } else if (platform === 'github') {
                    iconClass = 'fa-github';
                    typeText = 'GitHub';
                } else if (platform === 'facebook') {
                    iconClass = 'fa-facebook-f';
                    typeText = 'Facebook';
                } else if (platform === 'instagram') {
                    iconClass = 'fa-instagram';
                    typeText = 'Instagram';
                } else if (platform === 'x') {
                    iconClass = 'fa-x-twitter';
                    typeText = 'X';
                } else if (platform === 'linkedin') {
                    iconClass = 'fa-linkedin-in';
                    typeText = 'LinkedIn';
                }

                // Handle 'Coming Soon' state
                const isComingSoon = url === 'Coming Soon';
                const linkHref = isComingSoon ? '#' : url;
                const linkClass = isComingSoon ? 'coming-soon-link' : '';
                const linkTarget = isComingSoon ? '' : '_blank';


                const listItem = document.createElement('li');
                listItem.innerHTML = `
                    <i class="fab ${iconClass}" style="margin-right: 5px;"></i>
                    ${typeText}: 
                    <a href="${linkHref}" target="${linkTarget}" class="${linkClass}">
                        ${isComingSoon ? 'Coming Soon' : displayUrl}
                    </a>
                `;

                if (item.platform.includes('professional')) {
                    profContainer.appendChild(listItem);
                } else if (item.platform.includes('personal')) {
                    personalContainer.appendChild(listItem);
                }
            });
            
             // Ensure containers are cleared if no data was found
             if (profContainer.innerHTML === '') {
                 profContainer.innerHTML = '<li>No professional contact info found.</li>';
             }
             if (personalContainer.innerHTML === '') {
                 personalContainer.innerHTML = '<li>No personal contact info found.</li>';
             }
        }


        // --- Function to Render Projects ---
        async function loadLandingProjects() {
            const grid = document.getElementById('landing-projects-grid');
            if (!grid) return;
            
            try {
                const { data: projects, error } = await window.supabaseClient
                    .from('projects')
                    .select('*')
                    .or('status.eq.active,status.eq.coming_soon')
                    .eq('access_level', 'public') 
                    .order('display_order', { ascending: true });

                if (error) throw error;
                grid.innerHTML = ''; // Clear loading

                if (projects && projects.length > 0) {
                    projects.forEach(project => {
                        let iconClass = 'fa-rocket';
                        if (project.slug.includes('learn') || project.slug.includes('code')) {
                            iconClass = 'fa-graduation-cap';
                        } else if (project.slug.includes('tool')) {
                            iconClass = 'fa-tools';
                        }

                        let buttonHtml = '';
                        if (project.status === 'active') {
                            buttonHtml = `
                                <a href="${project.url || '#'}" class="project-btn">
                                    Visit Project <i class="fas fa-arrow-right"></i>
                                </a>`;
                        } else {
                            buttonHtml = `
                                <button class="project-btn coming-soon" disabled>
                                    Coming Soon <i class="fas fa-hourglass-half"></i>
                                </button>`;
                        }

                        const card = document.createElement('div');
                        card.className = 'project-card';
                        card.innerHTML = `
                            <h3><i class="fas ${iconClass}"></i> ${project.name}</h3>
                            <p>${project.description}</p>
                            ${buttonHtml}
                        `;
                        grid.appendChild(card);
                    });
                } else {
                    grid.innerHTML = '<p>No public projects listed yet.</p>';
                }

            } catch (err) {
                console.error("Error loading landing projects:", err);
                grid.innerHTML = '<p style="color: var(--error-red);">Unable to load projects.</p>';
            }
        }


        // --- Main Initializer ---
        document.addEventListener('DOMContentLoaded', async () => {
            // Wait for common functions to initialize Supabase client
            if (!window.supabaseClient) {
                setTimeout(() => document.dispatchEvent(new Event('DOMContentLoaded')), 100);
                return;
            }

            // Load Dynamic Content
            try {
                // 1. Load Page Content (About Me/ADV and Hero texts)
                const { data: contentData } = await window.supabaseClient
                    .from('pages_content')
                    .select('*');
                if (contentData) {
                    renderPageContent(contentData, 'about_me');
                    renderPageContent(contentData, 'about_adv');
                }

                // 2. Load Contact Info
                const { data: contactData } = await window.supabaseClient
                    .from('contact_info')
                    .select('*')
                    .eq('is_public', true);
                if (contactData) {
                    renderContactLinks(contactData);
                }

            } catch(error) {
                console.error("Error loading dynamic content:", error);
            }

            // Load Projects (defined above)
            await loadLandingProjects();
        });
    </script>
</body>
</html>
