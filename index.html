<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADV Technologies - Innovative Solutions</title>

    <link rel="icon" type="image/png" href="/assets/logo.png">
    <link rel="apple-touch-icon" href="/assets/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/css/styles.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>

</head>
<body>
    <canvas id="particles-canvas"></canvas>

    <nav class="navbar" id="navbar">
        <div class="container">
            <div class="logo">
                <img src="/assets/logo.png" alt="ADV Technologies Logo">
                <span style="font-weight: 700;">ADV</span>
            </div>
            <div class="menu-items">
                <a href="#projects">Projects</a>
                <a href="#contact">Contact</a>
            </div>
            
            <div class="user-profile" id="user-profile" style="display: none;">
                <div class="user-avatar" id="user-avatar">?</div>
                <span id="profile-username">User</span>
                <a href="/dashboard/" class="btn-small" style="margin-left: 1rem; text-decoration: none;">Dashboard</a>
                <button class="btn-small" onclick="window.authFunctions.logout()" style="margin-left: 0.5rem;">Logout</button>
            </div>
            
            <div class="auth-buttons" id="auth-buttons">
                <a href="/login/" class="btn-secondary">Login</a>
                <a href="/register/" class="btn-primary">Register</a>
            </div>
        </div>
    </nav>

    <header class="hero section">
        <div class="container">
            <div class="hero-content">
                <h1 id="hero-text-1">Welcome to ADV Technologies</h1>
                <p class="tagline" id="hero-text-2">Innovation with Integrity, Secured by Design.</p>
                <div class="hero-actions">
                    <a href="#projects" class="btn-primary">Explore Our Work</a>
                </div>
            </div>
        </div>
    </header>

    <section class="projects section" id="projects">
        <div class="container">
            <div class="glass-panel">
                <div class="projects-content">
                    <h2>Our Projects</h2>
                    <div class="projects-grid" id="landing-projects-grid">
                        <div style="text-align: center; color: var(--gold); width: 100%;">
                            <i class="fas fa-spinner fa-spin"></i> Loading Projects...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <section class="contact section" id="contact">
        <div class="container">
             <div class="glass-panel">
                <h2>Get In Touch</h2>
                <form id="contact-form" class="contact-form">
                    <div class="form-group">
                        <label for="name">Your Name</label>
                        <input type="text" id="name" required placeholder="John Doe">
                    </div>
                    <div class="form-group">
                        <label for="email">Your Email</label>
                        <input type="email" id="email" required placeholder="name@example.com">
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" rows="5" required placeholder="I'd like to collaborate on..."></textarea>
                    </div>
                    <button type="submit" class="btn-primary">Send Message</button>
                    <p id="contact-message" style="margin-top: 1rem; color: var(--gold);"></p>
                </form>
            </div>
        </div>
    </section>
    
    <footer class="footer">
        <div class="container">
            <p>&copy; <span id="current-year">2025</span> ADV Technologies. All rights reserved.</p>
            <div class="footer-links">
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
    </footer>


    <script>
        // Set up the Supabase configuration globally
        window.SUPABASE_CONFIG = {
            url: 'https://xblihylcpepkuriatqtg.supabase.co',
            anonKey: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhibGloeWxjcGVwa3VyaWF0cXRnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxMDEwNDIsImV4cCI6MjA3NzY3NzA0Mn0.Ka_dkjTcPmzfhTBmCrUNrfxU_G8UncebUwM5h-wlhns'
        };
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>

    <script src="/js/config.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/particles.js"></script>
    <script src="/js/auth.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const grid = document.getElementById('landing-projects-grid');
            if (!grid) return;

            // Wait for common functions to initialize Supabase client
            if (!window.supabaseClient) {
                console.warn("Supabase client not initialized yet. Retrying in 100ms...");
                setTimeout(() => document.dispatchEvent(new Event('DOMContentLoaded')), 100);
                return;
            }

            try {
                // 1. Fetch Public Projects from Database (Ordered by display_order)
                const { data: projects, error } = await window.supabaseClient
                    .from('projects')
                    .select('*')
                    .or('status.eq.active,status.eq.coming_soon')
                    .eq('access_level', 'public') 
                    .order('display_order', { ascending: true });

                if (error) throw error;

                // 2. Clear Loading Spinner
                grid.innerHTML = '';

                if (projects && projects.length > 0) {
                    projects.forEach(project => {
                        
                        // Icon Logic
                        let iconClass = 'fa-rocket';
                        if (project.slug.includes('learn') || project.slug.includes('code')) {
                            iconClass = 'fa-graduation-cap';
                        } else if (project.slug.includes('tool')) {
                            iconClass = 'fa-tools';
                        }

                        // Button Logic
                        let buttonHtml = '';
                        if (project.status === 'active') {
                            // If active, link to the URL
                            buttonHtml = `
                                <a href="${project.url || '#'}" class="project-btn">
                                    Visit Project <i class="fas fa-arrow-right"></i>
                                </a>`;
                        } else {
                            // If coming soon, show disabled button
                            buttonHtml = `
                                <button class="project-btn coming-soon" disabled>
                                    Coming Soon <i class="fas fa-hourglass-half"></i>
                                </button>`;
                        }

                        // Create the Card HTML
                        const card = document.createElement('div');
                        card.className = 'project-card';
                        card.innerHTML = `
                            <h3><i class="fas ${iconClass}"></i> ${project.name}</h3>
                            <p>${project.description}</p>
                            ${buttonHtml}
                        `;
                        grid.appendChild(card);
                    });
                } else {
                    grid.innerHTML = '<p>No public projects listed yet.</p>';
                }

            } catch (err) {
                console.error("Error loading landing projects:", err);
                grid.innerHTML = '<p style="color: var(--error-red);">Unable to load projects.</p>';
            }
        });

        // Contact Form Handler
        document.getElementById('contact-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const messageEl = document.getElementById('contact-message');
            messageEl.textContent = 'Sending...';

            // In a real application, you would send this data to a service/email handler.
            // For now, we simulate success.
            setTimeout(() => {
                messageEl.textContent = 'Thank you for your message! We will be in touch soon.';
                document.getElementById('contact-form').reset();
                setTimeout(() => { messageEl.textContent = ''; }, 5000);
            }, 1500);
        });
    </script>
</body>
</html>
